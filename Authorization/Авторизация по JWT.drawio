<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36" version="27.0.6">
  <diagram name="Страница — 1" id="MO3OTMnue6BbiVnNprnU">
    <mxGraphModel dx="1838" dy="2132" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="gVQaeOx12GYG1BFFBre4-157" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;fontColor=#ffffff;strokeColor=light-dark(#2D7600,#64B151);" parent="1" vertex="1">
          <mxGeometry x="-20" y="400" width="1030" height="690" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-158" value="Авторизация (проверка прав доступа)&#xa;" style="text;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=20;fontColor=light-dark(#000000,#80FF00);" parent="1" vertex="1">
          <mxGeometry x="330" y="410" width="380" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-18" value="&lt;font&gt;Фронтенд&lt;/font&gt;" style="swimlane;whiteSpace=wrap;html=1;fontSize=14;" parent="1" vertex="1">
          <mxGeometry y="-40" width="360" height="400" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-32" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;fontColor=#ffffff;strokeColor=light-dark(#2D7600,#64B151);" parent="gVQaeOx12GYG1BFFBre4-18" vertex="1">
          <mxGeometry x="-20" y="-50" width="1030" height="470" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-14" value="&lt;span style=&quot;text-wrap-mode: nowrap;&quot;&gt;1. Фронтенд отправляет учетные данные&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;text-wrap-mode: nowrap;&quot;&gt;&amp;nbsp;(логин и пароль)&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;POST /auth/login&lt;/span&gt;&lt;span style=&quot;text-wrap-mode: nowrap; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;.&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;" parent="gVQaeOx12GYG1BFFBre4-18" vertex="1">
          <mxGeometry x="20" y="40" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-26" value="5. Токены сохраняются на Фронтенде&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" parent="gVQaeOx12GYG1BFFBre4-18" vertex="1">
          <mxGeometry x="20" y="120" width="320" height="260" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-30" value="Аутентификация (проверка личности пользователя)" style="text;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=20;fontColor=light-dark(#000000,#80FF00);" parent="gVQaeOx12GYG1BFFBre4-18" vertex="1">
          <mxGeometry x="260" y="-50" width="510" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-19" value="&lt;span style=&quot;font-size: 12px; font-weight: 400; text-wrap-mode: nowrap;&quot;&gt;Бэкенд&lt;/span&gt;" style="swimlane;whiteSpace=wrap;html=1;fontSize=14;startSize=23;verticalAlign=top;" parent="gVQaeOx12GYG1BFFBre4-18" vertex="1">
          <mxGeometry x="640" width="347" height="400" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-20" value="&lt;span style=&quot;text-wrap-mode: nowrap;&quot;&gt;2. Бекенд выполняет п&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;оиск пользователя&amp;nbsp;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;в базе данных&lt;/span&gt;&lt;span style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;" parent="gVQaeOx12GYG1BFFBre4-19" vertex="1">
          <mxGeometry x="20" y="40" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="gVQaeOx12GYG1BFFBre4-19" source="gVQaeOx12GYG1BFFBre4-21" target="gVQaeOx12GYG1BFFBre4-24" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="175" y="190" />
              <mxPoint x="175" y="190" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-21" value="&lt;font&gt;&lt;span style=&quot;text-wrap-mode: nowrap;&quot;&gt;3.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif; text-align: start;&quot;&gt;Если пользователь не найден, возвращает&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;div&gt;&lt;font&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif; text-align: start;&quot;&gt;ошибку (&lt;/span&gt;&lt;code style=&quot;font-weight: var(--ds-font-weight-strong); font-family: var(--ds-font-family-code); border-radius: 4px; padding: 0.15rem 0.3rem; text-align: start;&quot;&gt;401 Unauthorized&lt;/code&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif; text-align: start;&quot;&gt;).&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontColor=default;" parent="gVQaeOx12GYG1BFFBre4-19" vertex="1">
          <mxGeometry x="18.5" y="120" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.506;entryY=0.003;entryDx=0;entryDy=0;entryPerimeter=0;" parent="gVQaeOx12GYG1BFFBre4-19" source="gVQaeOx12GYG1BFFBre4-20" target="gVQaeOx12GYG1BFFBre4-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-24" value="&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;text-wrap-mode: nowrap;&quot;&gt;4.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif; text-align: start;&quot;&gt;Если пользователь найден&lt;/span&gt;&lt;/font&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&amp;nbsp;а)&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;Сравнивает хеш полученного пароля с хешем, хранящимся в базе.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&amp;nbsp;б)&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;Генерирует&amp;nbsp;&lt;/span&gt;&lt;strong style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;access token&lt;/strong&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;(например, JWT) с данными пользователя (ID, роль, срок действия).&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&amp;nbsp;в)&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;Опционально создает&amp;nbsp;&lt;/span&gt;&lt;strong style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;refresh token&lt;/strong&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;для обновления access token.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;&amp;nbsp;г) О&lt;/span&gt;&lt;span style=&quot;font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif;&quot;&gt;тправляет токены фронтенду в ответе&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(41, 42, 45); font-family: DeepSeek-CJK-patch, Inter, system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Noto Sans&amp;quot;, Ubuntu, Cantarell, &amp;quot;Helvetica Neue&amp;quot;, Oxygen, &amp;quot;Open Sans&amp;quot;, sans-serif; font-size: 16.002px; text-align: left;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontColor=default;verticalAlign=top;" parent="gVQaeOx12GYG1BFFBre4-19" vertex="1">
          <mxGeometry x="20" y="200" width="310" height="180" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-50" value=" access token и refresh token" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;direction=west;" parent="gVQaeOx12GYG1BFFBre4-18" vertex="1">
          <mxGeometry x="340" y="320" width="320" height="55" as="geometry" />
        </mxCell>
        <mxCell id="i2bYRY76EgokexVLHt-v-1" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;- Access token&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;в&amp;nbsp;localStorage&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;sessionStorage&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;или&amp;nbsp;куках&amp;nbsp;(предпочтительно с флагом&amp;nbsp;HttpOnly&amp;nbsp;и&amp;nbsp;Secure&amp;nbsp;для безопасности).&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="gVQaeOx12GYG1BFFBre4-18">
          <mxGeometry x="40" y="190" width="280" height="70" as="geometry" />
        </mxCell>
        <mxCell id="i2bYRY76EgokexVLHt-v-2" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-align: center;&quot;&gt;- Refresh token только в защищенных куках с флагом&amp;nbsp;HttpOnly.&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="gVQaeOx12GYG1BFFBre4-18">
          <mxGeometry x="40" y="260" width="280" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-49" value="логин и пароль" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;" parent="1" vertex="1">
          <mxGeometry x="340" y="-7.5" width="320" height="55" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-34" value="6. В каждом запросе к защищенному API фронтенд отправляет access token" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="19.25" y="497.5" width="320" height="120" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-38" value="10.&amp;nbsp;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;При получении ошибки 401&amp;nbsp;&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Фронтенд в перехватчеке запросов отправляет запрос на обновление access токена с помощью&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;refresh&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;токена.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;POST /refresh.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 12.573px; text-align: start;&quot;&gt;Refresh токен из cookies&amp;nbsp; будет отправлен в запросе&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;автоматически&lt;/span&gt;&lt;span style=&quot;font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;.&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="19.25" y="657.5" width="320" height="142.5" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-35" value="7.&amp;nbsp;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Валидация access токена и проверка прав доступа.&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="659.25" y="497.5" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-36" value="9. Если токен не валидный возвращает &#xa;ошибку (401 Unauthorized).&#xa;Если нет прав доступа к ресурсу  ( 403 Forbidden)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="659.25" y="657.5" width="311.5" height="52.5" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-37" value="8. Если токен валидный&lt;div&gt;отвечает на запрос (status: 200)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="659.25" y="577.5" width="311.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-39" value="11.&amp;nbsp;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Валидация&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;refresh&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start;&quot;&gt;&amp;nbsp;токена&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="660.75" y="760" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-40" value="14.&amp;nbsp;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Если&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); background-color: transparent; font-size: 12.573px;&quot;&gt;refresh&lt;/span&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); background-color: transparent; font-size: 12.573px;&quot;&gt;&amp;nbsp;токен&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;невалиден&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); font-size: 12.573px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;div&gt;&lt;pre style=&quot;font-family: var(--ds-font-family-code); overflow: auto; padding: calc(var(--ds-md-zoom)*8px)calc(var(--ds-md-zoom)*12px); text-wrap-mode: wrap; word-break: break-all; font-size: 12.573px; margin-top: 0px !important; margin-bottom: 0px !important;&quot;&gt;возврат 401&lt;/pre&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="1" vertex="1">
          <mxGeometry x="660.75" y="977.5" width="310" height="72.5" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-41" value="12.&amp;nbsp;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Если&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); background-color: transparent; font-size: 12.573px;&quot;&gt;refresh&lt;/span&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); background-color: transparent; font-size: 12.573px;&quot;&gt;&amp;nbsp;токен&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;валиден&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: var(--ds-font-family-code); font-size: 12.573px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;div&gt;&lt;pre style=&quot;font-family: var(--ds-font-family-code); overflow: auto; padding: calc(var(--ds-md-zoom)*8px)calc(var(--ds-md-zoom)*12px); text-wrap-mode: wrap; word-break: break-all; font-size: 12.573px; margin-top: 0px !important; margin-bottom: 0px !important;&quot;&gt;&lt;pre style=&quot;font-family: var(--ds-font-family-code); overflow: auto; padding: calc(var(--ds-md-zoom)*8px)calc(var(--ds-md-zoom)*12px); text-wrap-mode: wrap; word-break: break-all; text-align: start; margin-top: 0px !important; margin-bottom: 0px !important;&quot;&gt;а) генерация нового access token.&lt;br&gt;б) обновление refresh (опционально). &lt;/pre&gt;&lt;/pre&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="1" vertex="1">
          <mxGeometry x="657.75" y="857.5" width="310" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-42" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;13. &lt;span style=&quot;font-size: 12.573px;&quot;&gt;Обновляем access токен.&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;font-size: 12.573px;&quot;&gt;Новый refresh токен сам записывается в куки.&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;font-size: 12.573px;&quot;&gt;И повторяет упавший запрос&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="1" vertex="1">
          <mxGeometry x="19.25" y="857.5" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-43" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;15.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;При ошибке обновления&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 12.573px;&quot;&gt;а)&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Удаление токенов.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;б)&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: var(--ds-font-family-code); font-size: 12.573px; text-align: start; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Редирект на /login.&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;" parent="1" vertex="1">
          <mxGeometry x="19.25" y="977.5" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-160" value="Фронтенд" style="swimlane;whiteSpace=wrap;html=1;fontSize=15;" parent="1" vertex="1">
          <mxGeometry y="457.5" width="360" height="612.5" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-161" value="Фронтенд" style="swimlane;whiteSpace=wrap;html=1;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="635.75" y="451.25" width="360" height="612.5" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-51" value="access token" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;" parent="1" vertex="1">
          <mxGeometry x="339.25" y="490" width="320" height="55" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-52" value="status: 200" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;direction=west;" parent="1" vertex="1">
          <mxGeometry x="339.25" y="567.5" width="320" height="55" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-162" value="401 Unauthorized / 403 Forbidden" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;direction=west;strokeColor=light-dark(#A20025,#FF0000);" parent="1" vertex="1">
          <mxGeometry x="337.75" y="656.25" width="320" height="55" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-163" value="cookies : refresh token" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;" parent="1" vertex="1">
          <mxGeometry x="340.75" y="752.5" width="320" height="55" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-165" value="401 Unauthorized" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;direction=west;strokeColor=light-dark(#A20025,#FF0000);" parent="1" vertex="1">
          <mxGeometry x="340.75" y="985" width="320" height="55" as="geometry" />
        </mxCell>
        <mxCell id="gVQaeOx12GYG1BFFBre4-166" value="Новые access token&amp;nbsp;и&amp;nbsp;refresh token" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;direction=west;" parent="1" vertex="1">
          <mxGeometry x="337.75" y="872.5" width="320" height="55" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
